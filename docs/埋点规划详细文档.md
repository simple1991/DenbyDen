# ğŸ“Š ç”µå•†ç½‘ç«™åŸ‹ç‚¹è§„åˆ’è¯¦ç»†æ–‡æ¡£

## ğŸ“‹ ç›®å½•
1. [æ•°æ®åº“è¡¨ç»“æ„è®¾è®¡](#æ•°æ®åº“è¡¨ç»“æ„è®¾è®¡)
2. [é¦–é¡µåŸ‹ç‚¹è¯¦æƒ…](#é¦–é¡µåŸ‹ç‚¹è¯¦æƒ…)
3. [äº§å“è¯¦æƒ…é¡µåŸ‹ç‚¹è¯¦æƒ…](#äº§å“è¯¦æƒ…é¡µåŸ‹ç‚¹è¯¦æƒ…)
4. [äº§å“å±•ç¤ºé¡µåŸ‹ç‚¹è¯¦æƒ…](#äº§å“å±•ç¤ºé¡µåŸ‹ç‚¹è¯¦æƒ…)
5. [å­ç±»å±•ç¤ºé¡µåŸ‹ç‚¹è¯¦æƒ…](#å­ç±»å±•ç¤ºé¡µåŸ‹ç‚¹è¯¦æƒ…)
6. [é€šç”¨åŸ‹ç‚¹è¯´æ˜](#é€šç”¨åŸ‹ç‚¹è¯´æ˜)

---

## æ•°æ®åº“è¡¨ç»“æ„è®¾è®¡

### 1. äº‹ä»¶è¡¨ (events)
å­˜å‚¨æ‰€æœ‰åŸ‹ç‚¹äº‹ä»¶çš„æ ¸å¿ƒè¡¨

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|
| id | uuid | ä¸»é”®ï¼Œè‡ªåŠ¨ç”Ÿæˆ | - |
| event_type | text | äº‹ä»¶ç±»å‹ | `product_view`, `product_click`, `add_to_cart` |
| event_category | text | äº‹ä»¶åˆ†ç±» | `exposure`, `click`, `conversion`, `interaction`, `lead` |
| page_type | text | é¡µé¢ç±»å‹ | `home`, `product_detail`, `shop`, `category` |
| page_url | text | é¡µé¢URL | `/`, `/product/strawberry-bunny-glass-container` |
| user_id | text | ç”¨æˆ·æ ‡è¯†ï¼ˆlocalStorageç”Ÿæˆçš„å”¯ä¸€IDï¼‰ | `user_abc123` |
| session_id | text | ä¼šè¯ID | `session_xyz789` |
| timestamp | timestamptz | äº‹ä»¶å‘ç”Ÿæ—¶é—´ | `2024-01-15 10:30:00+00` |
| created_at | timestamptz | è®°å½•åˆ›å»ºæ—¶é—´ | `2024-01-15 10:30:00+00` |

### 2. äº§å“æ›å…‰è¡¨ (product_exposures)
å­˜å‚¨äº§å“æ›å…‰ç›¸å…³æ•°æ®

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|
| id | uuid | ä¸»é”® | - |
| event_id | uuid | å…³è”äº‹ä»¶ID | - |
| product_id | text | äº§å“ID | `prod_001` |
| product_slug | text | äº§å“slug | `strawberry-bunny-glass-container` |
| position | integer | äº§å“åœ¨åˆ—è¡¨ä¸­çš„ä½ç½® | `1`, `5`, `12` |
| exposure_count | integer | æ›å…‰æ¬¡æ•°ï¼ˆåŒä¸€äº§å“åœ¨åŒä¸€ä½ç½®ï¼‰ | `1`, `2`, `3` |
| list_type | text | åˆ—è¡¨ç±»å‹ | `new_arrivals`, `popular_restocks`, `all_products`, `category` |
| viewport_position | text | è§†å£ä½ç½® | `above_fold`, `below_fold` |

### 3. äº§å“ç‚¹å‡»è¡¨ (product_clicks)
å­˜å‚¨äº§å“ç‚¹å‡»ç›¸å…³æ•°æ®

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|
| id | uuid | ä¸»é”® | - |
| event_id | uuid | å…³è”äº‹ä»¶ID | - |
| product_id | text | äº§å“ID | `prod_001` |
| product_slug | text | äº§å“slug | `strawberry-bunny-glass-container` |
| position | integer | ç‚¹å‡»æ—¶çš„ä½ç½® | `3` |
| click_type | text | ç‚¹å‡»ç±»å‹ | `card_click`, `add_to_cart_button`, `buy_now_button` |
| source_page | text | æ¥æºé¡µé¢ | `home`, `shop`, `category/rugs` |

### 4. è´­ç‰©è½¦æ“ä½œè¡¨ (cart_actions)
å­˜å‚¨è´­ç‰©è½¦ç›¸å…³æ“ä½œ

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|
| id | uuid | ä¸»é”® | - |
| event_id | uuid | å…³è”äº‹ä»¶ID | - |
| product_id | text | äº§å“ID | `prod_001` |
| product_slug | text | äº§å“slug | `strawberry-bunny-glass-container` |
| quantity | integer | æ•°é‡ | `1`, `2`, `3` |
| action_type | text | æ“ä½œç±»å‹ | `add`, `update`, `remove` |
| variant | text | é€‰æ‹©çš„å˜ä½“ | `red`, `blue`, `null` |
| gift_wrapping | boolean | æ˜¯å¦é€‰æ‹©ç¤¼å“åŒ…è£… | `true`, `false` |
| total_price | decimal | æ€»ä»· | `29.99` |

### 5. é‚®ç®±ç•™èµ„è¡¨ (email_captures)
å­˜å‚¨é‚®ç®±è®¢é˜…ç›¸å…³æ•°æ®

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|
| id | uuid | ä¸»é”® | - |
| event_id | uuid | å…³è”äº‹ä»¶ID | - |
| email | text | é‚®ç®±åœ°å€ | `user@example.com` |
| source_page | text | æ¥æºé¡µé¢ | `home`, `product_detail` |
| is_new_user | boolean | æ˜¯å¦æ–°ç”¨æˆ· | `true`, `false` |
| user_id | text | ç”¨æˆ·ID | `user_abc123` |

### 6. é¡µé¢äº¤äº’è¡¨ (page_interactions)
å­˜å‚¨é¡µé¢äº¤äº’ç›¸å…³æ•°æ®

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|
| id | uuid | ä¸»é”® | - |
| event_id | uuid | å…³è”äº‹ä»¶ID | - |
| interaction_type | text | äº¤äº’ç±»å‹ | `scroll_depth`, `image_swipe`, `section_expand`, `filter_select` |
| product_id | text | äº§å“IDï¼ˆå¦‚é€‚ç”¨ï¼‰ | `prod_001` |
| interaction_data | jsonb | äº¤äº’è¯¦ç»†æ•°æ® | `{"image_index": 2, "section_name": "DETAILS"}` |
| scroll_depth | integer | æ»šåŠ¨æ·±åº¦ï¼ˆç™¾åˆ†æ¯”ï¼‰ | `25`, `50`, `100` |

### 7. é¡µé¢åœç•™è¡¨ (page_dwell_time)
å­˜å‚¨é¡µé¢åœç•™æ—¶é•¿æ•°æ®

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|
| id | uuid | ä¸»é”® | - |
| event_id | uuid | å…³è”äº‹ä»¶ID | - |
| page_type | text | é¡µé¢ç±»å‹ | `home`, `product_detail`, `shop` |
| page_url | text | é¡µé¢URL | `/`, `/product/strawberry-bunny-glass-container` |
| product_id | text | äº§å“IDï¼ˆå¦‚é€‚ç”¨ï¼‰ | `prod_001` |
| dwell_time_seconds | integer | åœç•™æ—¶é•¿ï¼ˆç§’ï¼‰ | `45`, `120`, `300` |
| is_bounce | boolean | æ˜¯å¦è·³å‡º | `true`, `false` |

---

## é¦–é¡µåŸ‹ç‚¹è¯¦æƒ…

### é¡µé¢URL
`http://localhost:3000/`

### 1. äº§å“å¡ç‰‡æ›å…‰ï¼ˆåˆ—è¡¨é¡µ/é¦–é¡µï¼‰

**è§¦å‘æ—¶æœºï¼š**
- äº§å“å¡ç‰‡è¿›å…¥è§†å£æ—¶ï¼ˆä½¿ç”¨ Intersection Observerï¼‰
- é¡µé¢åŠ è½½æ—¶ï¼Œé¦–å±äº§å“è‡ªåŠ¨æ›å…‰

**ä¸Šä¼ æ•°æ®ï¼š**
```json
{
  "event_type": "product_exposure",
  "event_category": "exposure",
  "page_type": "home",
  "page_url": "/",
  "product_id": "prod_001",
  "product_slug": "strawberry-bunny-glass-container",
  "position": 1,
  "exposure_count": 1,
  "list_type": "new_arrivals",
  "viewport_position": "above_fold"
}
```

**æ•°æ®è¡¨ï¼š**
- `events` - ä¸»äº‹ä»¶è®°å½•
- `product_exposures` - æ›å…‰è¯¦æƒ…

**å®ç°è¦ç‚¹ï¼š**
- ä½¿ç”¨ Intersection Observer API æ£€æµ‹äº§å“å¡ç‰‡æ˜¯å¦è¿›å…¥è§†å£
- é˜²æŠ–å¤„ç†ï¼Œé¿å…é‡å¤ä¸ŠæŠ¥ï¼ˆåŒä¸€äº§å“åŒä¸€ä½ç½®5ç§’å†…åªä¸ŠæŠ¥ä¸€æ¬¡ï¼‰
- åŒºåˆ†é¦–å±ï¼ˆabove_foldï¼‰å’Œéé¦–å±ï¼ˆbelow_foldï¼‰

---

### 2. ç‚¹å‡»äº§å“å¡ç‰‡

**è§¦å‘æ—¶æœºï¼š**
- ç”¨æˆ·ç‚¹å‡»äº§å“å¡ç‰‡ï¼ˆå›¾ç‰‡æˆ–æ ‡é¢˜åŒºåŸŸï¼‰

**ä¸Šä¼ æ•°æ®ï¼š**
```json
{
  "event_type": "product_click",
  "event_category": "click",
  "page_type": "home",
  "page_url": "/",
  "product_id": "prod_001",
  "product_slug": "strawberry-bunny-glass-container",
  "position": 3,
  "click_type": "card_click",
  "source_page": "home"
}
```

**æ•°æ®è¡¨ï¼š**
- `events` - ä¸»äº‹ä»¶è®°å½•
- `product_clicks` - ç‚¹å‡»è¯¦æƒ…

---

### 3. ç‚¹å‡»"åŠ å…¥è´­ç‰©è½¦"æŒ‰é’®

**è§¦å‘æ—¶æœºï¼š**
- ç”¨æˆ·åœ¨äº§å“å¡ç‰‡ä¸Šæ‚¬åœåç‚¹å‡»"Add to Cart"æŒ‰é’®

**ä¸Šä¼ æ•°æ®ï¼š**
```json
{
  "event_type": "add_to_cart",
  "event_category": "click",
  "page_type": "home",
  "page_url": "/",
  "product_id": "prod_001",
  "product_slug": "strawberry-bunny-glass-container",
  "quantity": 1,
  "action_type": "add",
  "variant": null,
  "gift_wrapping": false,
  "total_price": 29.99,
  "position": 2
}
```

**æ•°æ®è¡¨ï¼š**
- `events` - ä¸»äº‹ä»¶è®°å½•
- `cart_actions` - è´­ç‰©è½¦æ“ä½œè¯¦æƒ…
- `product_clicks` - ç‚¹å‡»è¯¦æƒ…ï¼ˆclick_type: "add_to_cart_button"ï¼‰

---

### 4. é‚®ç®±å¼¹çª—æäº¤

**è§¦å‘æ—¶æœºï¼š**
- ç”¨æˆ·å¡«å†™é‚®ç®±å¹¶ç‚¹å‡»"Subscribe"æŒ‰é’®
- æäº¤æˆåŠŸåè®°å½•

**ä¸Šä¼ æ•°æ®ï¼š**
```json
{
  "event_type": "email_submit",
  "event_category": "lead",
  "page_type": "home",
  "page_url": "/",
  "email": "user@example.com",
  "source_page": "home",
  "is_new_user": true
}
```

**æ•°æ®è¡¨ï¼š**
- `events` - ä¸»äº‹ä»¶è®°å½•
- `email_captures` - é‚®ç®±ç•™èµ„è¯¦æƒ…

**å®ç°è¦ç‚¹ï¼š**
- æ£€æŸ¥ localStorage åˆ¤æ–­æ˜¯å¦ä¸ºæ–°ç”¨æˆ·
- é‚®ç®±åœ°å€éœ€è¦è„±æ•å¤„ç†ï¼ˆä»…å­˜å‚¨ï¼Œä¸ä¸ŠæŠ¥å®Œæ•´é‚®ç®±ï¼‰

---

### 5. é¡µé¢åœç•™æ—¶é•¿

**è§¦å‘æ—¶æœºï¼š**
- é¡µé¢åŠ è½½æ—¶å¼€å§‹è®¡æ—¶
- é¡µé¢å¸è½½æ—¶æˆ–ç”¨æˆ·ç¦»å¼€æ—¶ä¸ŠæŠ¥

**ä¸Šä¼ æ•°æ®ï¼š**
```json
{
  "event_type": "page_dwell",
  "event_category": "interaction",
  "page_type": "home",
  "page_url": "/",
  "dwell_time_seconds": 120,
  "is_bounce": false
}
```

**æ•°æ®è¡¨ï¼š**
- `events` - ä¸»äº‹ä»¶è®°å½•
- `page_dwell_time` - åœç•™æ—¶é•¿è¯¦æƒ…

**å®ç°è¦ç‚¹ï¼š**
- ä½¿ç”¨ `beforeunload` å’Œ `visibilitychange` äº‹ä»¶
- åœç•™æ—¶é•¿å°äº3ç§’è§†ä¸ºè·³å‡ºï¼ˆbounceï¼‰

---

### 6. è·³å‡ºç‡

**è§¦å‘æ—¶æœºï¼š**
- é¡µé¢å¸è½½æ—¶ï¼Œå¦‚æœåœç•™æ—¶é•¿ < 3ç§’ï¼Œè®°å½•ä¸ºè·³å‡º

**ä¸Šä¼ æ•°æ®ï¼š**
```json
{
  "event_type": "page_bounce",
  "event_category": "interaction",
  "page_type": "home",
  "page_url": "/",
  "dwell_time_seconds": 2,
  "is_bounce": true
}
```

**æ•°æ®è¡¨ï¼š**
- `events` - ä¸»äº‹ä»¶è®°å½•
- `page_dwell_time` - åœç•™æ—¶é•¿è¯¦æƒ…

---

## äº§å“è¯¦æƒ…é¡µåŸ‹ç‚¹è¯¦æƒ…

### é¡µé¢URL
`http://localhost:3000/product/[slug]`

### 1. äº§å“è¯¦æƒ…é¡µæ›å…‰

**è§¦å‘æ—¶æœºï¼š**
- é¡µé¢åŠ è½½å®Œæˆï¼ˆuseEffectï¼‰

**ä¸Šä¼ æ•°æ®ï¼š**
```json
{
  "event_type": "product_detail_view",
  "event_category": "exposure",
  "page_type": "product_detail",
  "page_url": "/product/strawberry-bunny-glass-container",
  "product_id": "prod_001",
  "product_slug": "strawberry-bunny-glass-container",
  "source_page": "home"
}
```

**æ•°æ®è¡¨ï¼š**
- `events` - ä¸»äº‹ä»¶è®°å½•
- `product_exposures` - æ›å…‰è¯¦æƒ…ï¼ˆposition: 0, list_type: "detail"ï¼‰

**å®ç°è¦ç‚¹ï¼š**
- ä» `document.referrer` æˆ–è·¯ç”±çŠ¶æ€è·å–æ¥æºé¡µé¢

---

### 2. æ»‘åŠ¨æŸ¥çœ‹å›¾ç‰‡

**è§¦å‘æ—¶æœºï¼š**
- ç”¨æˆ·ç‚¹å‡»ç¼©ç•¥å›¾åˆ‡æ¢ä¸»å›¾
- ç§»åŠ¨ç«¯æ»‘åŠ¨åˆ‡æ¢å›¾ç‰‡

**ä¸Šä¼ æ•°æ®ï¼š**
```json
{
  "event_type": "image_swipe",
  "event_category": "interaction",
  "page_type": "product_detail",
  "page_url": "/product/strawberry-bunny-glass-container",
  "product_id": "prod_001",
  "interaction_type": "image_swipe",
  "interaction_data": {
    "image_index": 2,
    "total_images": 4
  }
}
```

**æ•°æ®è¡¨ï¼š**
- `events` - ä¸»äº‹ä»¶è®°å½•
- `page_interactions` - äº¤äº’è¯¦æƒ…

---

### 3. æŸ¥çœ‹"è¯¦æƒ…/è§„æ ¼/æè´¨"æŠ˜å åŒº

**è§¦å‘æ—¶æœºï¼š**
- ç”¨æˆ·ç‚¹å‡»æŠ˜å åŒºåŸŸå±•å¼€å†…å®¹

**ä¸Šä¼ æ•°æ®ï¼š**
```json
{
  "event_type": "section_expand",
  "event_category": "interaction",
  "page_type": "product_detail",
  "page_url": "/product/strawberry-bunny-glass-container",
  "product_id": "prod_001",
  "interaction_type": "section_expand",
  "interaction_data": {
    "section_name": "DETAILS",
    "section_type": "collapsible"
  }
}
```

**æ•°æ®è¡¨ï¼š**
- `events` - ä¸»äº‹ä»¶è®°å½•
- `page_interactions` - äº¤äº’è¯¦æƒ…

**å¯å±•å¼€çš„æ¨¡å—ï¼š**
- FEATURES
- DETAILS
- MATERIALS
- CARE INSTRUCTION
- SHIPPING & RETURN

---

### 4. åŒ…è£…é€‰æ‹©é€‰ä¸­

**è§¦å‘æ—¶æœºï¼š**
- ç”¨æˆ·åˆ‡æ¢"Christmas Gift Wrapping"å¼€å…³

**ä¸Šä¼ æ•°æ®ï¼š**
```json
{
  "event_type": "gift_wrapping_toggle",
  "event_category": "interaction",
  "page_type": "product_detail",
  "page_url": "/product/strawberry-bunny-glass-container",
  "product_id": "prod_001",
  "interaction_type": "gift_wrapping_select",
  "interaction_data": {
    "gift_wrapping": true
  }
}
```

**æ•°æ®è¡¨ï¼š**
- `events` - ä¸»äº‹ä»¶è®°å½•
- `page_interactions` - äº¤äº’è¯¦æƒ…

---

### 5. ç‚¹å‡»"åŠ å…¥è´­ç‰©è½¦"

**è§¦å‘æ—¶æœºï¼š**
- ç”¨æˆ·ç‚¹å‡»"Add to Cart"æŒ‰é’®

**ä¸Šä¼ æ•°æ®ï¼š**
```json
{
  "event_type": "add_to_cart",
  "event_category": "conversion",
  "page_type": "product_detail",
  "page_url": "/product/strawberry-bunny-glass-container",
  "product_id": "prod_001",
  "product_slug": "strawberry-bunny-glass-container",
  "quantity": 2,
  "action_type": "add",
  "variant": "red",
  "gift_wrapping": true,
  "total_price": 59.98
}
```

**æ•°æ®è¡¨ï¼š**
- `events` - ä¸»äº‹ä»¶è®°å½•
- `cart_actions` - è´­ç‰©è½¦æ“ä½œè¯¦æƒ…

---

### 6. é¡µé¢åœç•™æ—¶é•¿

**è§¦å‘æ—¶æœºï¼š**
- é¡µé¢å¸è½½æ—¶ä¸ŠæŠ¥

**ä¸Šä¼ æ•°æ®ï¼š**
```json
{
  "event_type": "page_dwell",
  "event_category": "interaction",
  "page_type": "product_detail",
  "page_url": "/product/strawberry-bunny-glass-container",
  "product_id": "prod_001",
  "dwell_time_seconds": 180,
  "is_bounce": false
}
```

**æ•°æ®è¡¨ï¼š**
- `events` - ä¸»äº‹ä»¶è®°å½•
- `page_dwell_time` - åœç•™æ—¶é•¿è¯¦æƒ…

---

## äº§å“å±•ç¤ºé¡µåŸ‹ç‚¹è¯¦æƒ…

### é¡µé¢URL
`http://localhost:3000/shop`

### 1. äº§å“å¡ç‰‡æ›å…‰

**è§¦å‘æ—¶æœºï¼š**
- äº§å“å¡ç‰‡è¿›å…¥è§†å£æ—¶

**ä¸Šä¼ æ•°æ®ï¼š**
```json
{
  "event_type": "product_exposure",
  "event_category": "exposure",
  "page_type": "shop",
  "page_url": "/shop",
  "product_id": "prod_001",
  "product_slug": "strawberry-bunny-glass-container",
  "position": 5,
  "exposure_count": 1,
  "list_type": "all_products",
  "viewport_position": "below_fold"
}
```

**æ•°æ®è¡¨ï¼š**
- `events` - ä¸»äº‹ä»¶è®°å½•
- `product_exposures` - æ›å…‰è¯¦æƒ…

---

### 2. ç‚¹å‡»äº§å“å¡ç‰‡è¿›å…¥è¯¦æƒ…é¡µ

**è§¦å‘æ—¶æœºï¼š**
- ç”¨æˆ·ç‚¹å‡»äº§å“å¡ç‰‡

**ä¸Šä¼ æ•°æ®ï¼š**
```json
{
  "event_type": "product_click",
  "event_category": "click",
  "page_type": "shop",
  "page_url": "/shop",
  "product_id": "prod_001",
  "product_slug": "strawberry-bunny-glass-container",
  "position": 8,
  "click_type": "card_click",
  "source_page": "shop"
}
```

**æ•°æ®è¡¨ï¼š**
- `events` - ä¸»äº‹ä»¶è®°å½•
- `product_clicks` - ç‚¹å‡»è¯¦æƒ…

---

### 3. åŠ å…¥è´­ç‰©è½¦æˆåŠŸ

**è§¦å‘æ—¶æœºï¼š**
- ç”¨æˆ·ç‚¹å‡»"Add to Cart"æŒ‰é’®å¹¶æˆåŠŸæ·»åŠ 

**ä¸Šä¼ æ•°æ®ï¼š**
```json
{
  "event_type": "add_to_cart",
  "event_category": "conversion",
  "page_type": "shop",
  "page_url": "/shop",
  "product_id": "prod_001",
  "product_slug": "strawberry-bunny-glass-container",
  "quantity": 1,
  "action_type": "add",
  "total_price": 29.99,
  "position": 3
}
```

**æ•°æ®è¡¨ï¼š**
- `events` - ä¸»äº‹ä»¶è®°å½•
- `cart_actions` - è´­ç‰©è½¦æ“ä½œè¯¦æƒ…

---

### 4. æ»‘åŠ¨æµè§ˆï¼ˆæ»šåŠ¨æ·±åº¦ï¼‰

**è§¦å‘æ—¶æœºï¼š**
- ç”¨æˆ·æ»šåŠ¨é¡µé¢æ—¶ï¼Œæ¯25%æ·±åº¦ä¸ŠæŠ¥ä¸€æ¬¡

**ä¸Šä¼ æ•°æ®ï¼š**
```json
{
  "event_type": "scroll_depth",
  "event_category": "interaction",
  "page_type": "shop",
  "page_url": "/shop",
  "interaction_type": "scroll_depth",
  "scroll_depth": 50,
  "interaction_data": {
    "products_exposed": 12
  }
}
```

**æ•°æ®è¡¨ï¼š**
- `events` - ä¸»äº‹ä»¶è®°å½•
- `page_interactions` - äº¤äº’è¯¦æƒ…

**å®ç°è¦ç‚¹ï¼š**
- è®°å½•æ»šåŠ¨æ·±åº¦ï¼š0%, 25%, 50%, 75%, 100%
- æ¯ä¸ªæ·±åº¦åªä¸ŠæŠ¥ä¸€æ¬¡

---

## å­ç±»å±•ç¤ºé¡µåŸ‹ç‚¹è¯¦æƒ…

### é¡µé¢URL
`http://localhost:3000/shop/[category]`

### 1. äº§å“å¡ç‰‡æ›å…‰

**è§¦å‘æ—¶æœºï¼š**
- äº§å“å¡ç‰‡è¿›å…¥è§†å£æ—¶

**ä¸Šä¼ æ•°æ®ï¼š**
```json
{
  "event_type": "product_exposure",
  "event_category": "exposure",
  "page_type": "category",
  "page_url": "/shop/rugs",
  "product_id": "prod_001",
  "product_slug": "strawberry-bunny-glass-container",
  "position": 1,
  "exposure_count": 1,
  "list_type": "category",
  "category": "rugs"
}
```

**æ•°æ®è¡¨ï¼š**
- `events` - ä¸»äº‹ä»¶è®°å½•
- `product_exposures` - æ›å…‰è¯¦æƒ…

---

### 2. ç‚¹å‡»äº§å“å¡ç‰‡è¿›å…¥è¯¦æƒ…é¡µ

**è§¦å‘æ—¶æœºï¼š**
- ç”¨æˆ·ç‚¹å‡»äº§å“å¡ç‰‡

**ä¸Šä¼ æ•°æ®ï¼š**
```json
{
  "event_type": "product_click",
  "event_category": "click",
  "page_type": "category",
  "page_url": "/shop/rugs",
  "product_id": "prod_001",
  "product_slug": "strawberry-bunny-glass-container",
  "position": 2,
  "click_type": "card_click",
  "source_page": "category/rugs"
}
```

**æ•°æ®è¡¨ï¼š**
- `events` - ä¸»äº‹ä»¶è®°å½•
- `product_clicks` - ç‚¹å‡»è¯¦æƒ…

---

### 3. ç­›é€‰/æ’åºæ“ä½œ

**è§¦å‘æ—¶æœºï¼š**
- ç”¨æˆ·é€‰æ‹©ç­›é€‰æ¡ä»¶æˆ–æ’åºæ–¹å¼ï¼ˆå¦‚æœé¡µé¢æœ‰è¿™äº›åŠŸèƒ½ï¼‰

**ä¸Šä¼ æ•°æ®ï¼š**
```json
{
  "event_type": "filter_select",
  "event_category": "interaction",
  "page_type": "category",
  "page_url": "/shop/rugs",
  "interaction_type": "filter_select",
  "interaction_data": {
    "filter_type": "price",
    "filter_value": "low_to_high",
    "result_count": 15
  }
}
```

**æ•°æ®è¡¨ï¼š**
- `events` - ä¸»äº‹ä»¶è®°å½•
- `page_interactions` - äº¤äº’è¯¦æƒ…

---

## é€šç”¨åŸ‹ç‚¹è¯´æ˜

### ç”¨æˆ·æ ‡è¯†ï¼ˆuser_idï¼‰
- é¦–æ¬¡è®¿é—®æ—¶ï¼Œåœ¨ localStorage ç”Ÿæˆå”¯ä¸€IDï¼š`user_${timestamp}_${random}`
- åç»­è®¿é—®å¤ç”¨è¯¥ID

### ä¼šè¯æ ‡è¯†ï¼ˆsession_idï¼‰
- æ¯æ¬¡é¡µé¢åŠ è½½æ—¶ç”Ÿæˆï¼š`session_${timestamp}_${random}`
- åŒä¸€æ ‡ç­¾é¡µå†…ä¼šè¯IDä¿æŒä¸€è‡´
- æ–°æ ‡ç­¾é¡µæˆ–åˆ·æ–°é¡µé¢æ—¶ç”Ÿæˆæ–°çš„ä¼šè¯ID

### æ—¶é—´æˆ³
- æ‰€æœ‰æ—¶é—´ä½¿ç”¨ UTC æ—¶é—´
- æ ¼å¼ï¼šISO 8601

### æ•°æ®ä¸ŠæŠ¥ç­–ç•¥
1. **å®æ—¶ä¸ŠæŠ¥**ï¼šå…³é”®è½¬åŒ–äº‹ä»¶ï¼ˆåŠ å…¥è´­ç‰©è½¦ã€é‚®ç®±æäº¤ï¼‰
2. **æ‰¹é‡ä¸ŠæŠ¥**ï¼šæ›å…‰ç±»äº‹ä»¶ï¼Œæ¯5ç§’æˆ–ç´¯ç§¯10æ¡åæ‰¹é‡ä¸ŠæŠ¥
3. **å»¶è¿Ÿä¸ŠæŠ¥**ï¼šé¡µé¢åœç•™æ—¶é•¿ï¼Œé¡µé¢å¸è½½æ—¶ä¸ŠæŠ¥

### é”™è¯¯å¤„ç†
- ç½‘ç»œé”™è¯¯æ—¶ï¼Œæ•°æ®æš‚å­˜åˆ° localStorage
- é¡µé¢é‡æ–°åŠ è½½æ—¶ï¼Œå°è¯•é‡æ–°ä¸ŠæŠ¥
- æœ€å¤šé‡è¯•3æ¬¡ï¼Œè¶…è¿‡3æ¬¡åˆ™ä¸¢å¼ƒ

### éšç§ä¿æŠ¤
- é‚®ç®±åœ°å€ä»…å­˜å‚¨ï¼Œä¸å®Œæ•´ä¸ŠæŠ¥ï¼ˆå¯ä¸ŠæŠ¥hashå€¼ï¼‰
- ä¸æ”¶é›†ç”¨æˆ·IPåœ°å€
- ä¸æ”¶é›†è®¾å¤‡æŒ‡çº¹ä¿¡æ¯

---

## æ•°æ®ä¸ŠæŠ¥ç¤ºä¾‹ä»£ç ç»“æ„

```typescript
// ä¸ŠæŠ¥å‡½æ•°ç¤ºä¾‹
trackEvent({
  event_type: 'product_exposure',
  event_category: 'exposure',
  page_type: 'home',
  page_url: '/',
  product_id: 'prod_001',
  // ... å…¶ä»–å­—æ®µ
})
```

---

## åç»­åˆ†ææŒ‡æ ‡

åŸºäºä»¥ä¸ŠåŸ‹ç‚¹æ•°æ®ï¼Œå¯ä»¥åˆ†æï¼š

1. **äº§å“è¡¨ç°**
   - å„äº§å“çš„æ›å…‰æ¬¡æ•°ã€ç‚¹å‡»ç‡
   - è½¬åŒ–ç‡ï¼ˆæ›å…‰â†’ç‚¹å‡»â†’åŠ è´­ï¼‰
   - çƒ­é—¨äº§å“æ’è¡Œ

2. **é¡µé¢è¡¨ç°**
   - å„é¡µé¢çš„åœç•™æ—¶é•¿
   - è·³å‡ºç‡åˆ†æ
   - é¡µé¢ä¼˜åŒ–æ–¹å‘

3. **ç”¨æˆ·è¡Œä¸º**
   - ç”¨æˆ·æµè§ˆè·¯å¾„
   - æ»šåŠ¨æ·±åº¦åˆ†æ
   - äº¤äº’åå¥½

4. **è½¬åŒ–æ¼æ–—**
   - é¦–é¡µ â†’ è¯¦æƒ…é¡µ â†’ åŠ è´­ â†’ è´­ä¹°
   - å„ç¯èŠ‚è½¬åŒ–ç‡

5. **è¥é”€æ•ˆæœ**
   - é‚®ç®±ç•™èµ„è½¬åŒ–ç‡
   - æ–°ç”¨æˆ· vs è€ç”¨æˆ·è¡Œä¸ºå·®å¼‚

